{% extends 'weatherly_app/base.html' %}
{% load static %}

{% block title %}Prognoza dla {{ weather.location.name }}{% endblock %}

{% block extra_css %}
<style>
    .weather-card {
        transition: transform 0.3s;
    }
    .weather-card:hover {
        transform: translateY(-5px);
    }
    .current-weather-icon {
        width: 100px;
        height: 100px;
    }
</style>
{% endblock %}

{% block content %}
<div class="row">
    <div class="col-12">
        <div class="d-flex justify-content-between align-items-center mb-4">
            <h1>
                <i class="fas fa-map-marker-alt text-danger me-2"></i>
                {{ weather.location.name }}, {{ weather.location.country }}
            </h1>
            <span class="badge bg-secondary">
                Ostatnia aktualizacja: {{ weather.current.last_updated|date:"H:i" }}
            </span>
        </div>
    </div>
</div>

<!-- Bieżąca pogoda -->
<div class="card mb-4 shadow">
    <div class="card-header bg-primary text-white">
        <h3 class="mb-0">Aktualna pogoda</h3>
    </div>
    <div class="card-body">
        <div class="row align-items-center">
            <div class="col-md-4 text-center">
                <img src="{{ weather.current.condition.icon }}" alt="{{ weather.current.condition.text }}" 
                     class="current-weather-icon mb-3">
                <h3>{{ weather.current.condition.text }}</h3>
            </div>
            <div class="col-md-4">
                <div class="display-1 text-center">
                    {{ weather.current.temp_c }}°C
                </div>
            </div>
            <div class="col-md-4">
                <ul class="list-unstyled">
                    <li class="mb-2"><i class="fas fa-temperature-low me-2"></i> Odczuwalna: {{ weather.current.feelslike_c }}°C</li>
                    <li class="mb-2"><i class="fas fa-wind me-2"></i> Wiatr: {{ weather.current.wind_kph }} km/h</li>
                    <li class="mb-2"><i class="fas fa-tint me-2"></i> Wilgotność: {{ weather.current.humidity }}%</li>
                    <li class="mb-2"><i class="fas fa-eye me-2"></i> Widoczność: {{ weather.current.vis_km }} km</li>
                    <li class="mb-2"><i class="fas fa-cloud-rain me-2"></i> Opady: {{ weather.current.precip_mm }} mm</li>
                </ul>
            </div>
        </div>
    </div>
</div>

<!-- Prognoza godzinowa -->
<div class="card mb-4 shadow">
    <div class="card-header bg-info text-white">
        <h3 class="mb-0">Prognoza godzinowa</h3>
    </div>
    <div class="card-body">
        <div class="row g-2">
            {% for hour in weather.forecast.forecastday.0.hour|slice:":12" %}
            <div class="col-6 col-md-4 col-lg-2">
                <div class="weather-card card h-100">
                    <div class="card-body text-center">
                        <h6 class="card-title">{{ hour.time|slice:"11:16" }}</h6>
                        <img src="{{ hour.condition.icon }}" alt="{{ hour.condition.text }}" class="img-fluid mb-2">
                        <p class="mb-1">{{ hour.temp_c }}°C</p>
                        <small class="text-muted">{{ hour.condition.text }}</small>
                    </div>
                </div>
            </div>
            {% endfor %}
        </div>
    </div>
</div>

<!-- Prognoza dzienna -->
<div class="card shadow">
    <div class="card-header bg-success text-white">
        <h3 class="mb-0">Prognoza na najbliższe dni</h3>
    </div>
    <div class="card-body">
        <div class="row">
            {% for day in weather.forecast.forecastday %}
            <div class="col-md-4 mb-3">
                <div class="weather-card card h-100">
                    <div class="card-header">
                        <h5 class="mb-0">{{ day.date|date:"l" }}, {{ day.date }}</h5>
                    </div>
                    <div class="card-body text-center">
                        <div class="d-flex justify-content-around align-items-center mb-3">
                            <div>
                                <img src="{{ day.day.condition.icon }}" alt="{{ day.day.condition.text }}" class="img-fluid">
                                <p>{{ day.day.condition.text }}</p>
                            </div>
                            <div>
                                <span class="display-6">{{ day.day.maxtemp_c }}°C</span>
                                <span class="text-muted">/ {{ day.day.mintemp_c }}°C</span>
                            </div>
                        </div>
                        <div class="row text-start small">
                            <div class="col-6">
                                <p><i class="fas fa-sun me-1"></i> Wschód: {{ day.astro.sunrise }}</p>
                                <p><i class="fas fa-wind me-1"></i> Wiatr: {{ day.day.maxwind_kph }} km/h</p>
                            </div>
                            <div class="col-6">
                                <p><i class="fas fa-moon me-1"></i> Zachód: {{ day.astro.sunset }}</p>
                                <p><i class="fas fa-tint me-1"></i> Opady: {{ day.day.totalprecip_mm }} mm</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            {% endfor %}
        </div>
    </div>
</div>

<div class="mt-4 text-center">
    <a href="{% url 'index' %}" class="btn btn-outline-primary">
        <i class="fas fa-arrow-left me-1"></i> Wróć do wyszukiwania
    </a>
</div>
{% endblock %}

{% block extra_js %}
<script>
// Prosta walidacja formularza
document.addEventListener('DOMContentLoaded', function() {
    const forms = document.querySelectorAll('.needs-validation');
    
    Array.from(forms).forEach(form => {
        form.addEventListener('submit', function(event) {
            if (!form.checkValidity()) {
                event.preventDefault();
                event.stopPropagation();
            }
            form.classList.add('was-validated');
        }, false);
    });
});
</script>
{% endblock %}